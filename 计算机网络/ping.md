## ping

>  **Mike Muuss**（1983 年编写了首个 Unix 版本的 ping 程序）在自述中明确表示：他将网络探测的逻辑类比为声纳回声定位，因此用 “ping” 这个拟声词命名，形象地体现了 “发送请求并等待回声（应答）” 的过程。

### 概述

`ping` 是一种**网络诊断工具**，用于测试两台主机（如你的设备与某网站服务器）之间的**连通性**，同时可测量数据传输的**延迟（往返时间）**、**丢包率**等关键网络指标。它是网络运维、日常排查网络问题（如 “为什么网页打不开”）的基础手段。

### 工作原理

`ping` 基于 **ICMP（互联网控制消息协议）** 实现，核心流程如下：

1. **发送请求**：你的设备向目标主机发送 **ICMP 回显请求（Echo Request）** 数据包，数据包中包含一个 “标识符” 和 “序列号”，用于后续匹配响应。
2. **接收应答**：如果目标主机在线且网络连通，它会返回 **ICMP 回显应答（Echo Reply）** 数据包，包含与请求一致的标识符和序列号。

### 示例

在 **Ubuntu系统** 中对 `github.com` 执行 `ping` 命令的网络测试结果：

<div align="center">
  <img src="assets/PING.png" height="200">
</div>

其中，`-c 3` 是 Linux 系统特有的参数，指定发送 **3 个 ICMP 数据包**；`20.205.243.166 `是 GitHub 服务器的一个 IP 地址（会因网络环境动态解析）；ICMP 请求原始数据为 56 字节，ICMP 头为8 字节，因此每个响应数据包的有效数据为 64 字节，加上 IP 头（20 字节）后总长度为 84 字节；`icmp_seq=1/2/3` 为 ICMP 数据包的 “序列号”，用于标识每个请求的顺序；`ttl=100` 为“生存时间”，表示数据包在网络中可经过的最大路由器**跳数**（数值越高，网络路径相对更 “直接”）；`rtt` 是**往返时间**（Round-Trip Time），即数据包从本地到 GitHub 服务器再返回的时间，反映网络延迟，其中 **mdev** 表示标准偏差/抖动，越小越稳定。

### TTL 解析

**TTL (Time To Live)** 是 IP 数据包头部中的一个字段，用于防止数据包在网络中无限循环（例如若网络中存在路由环路（如 R1→R2→R3→R1），则数据包会在环路中无限循环）。它的值表示数据包在网络中可以经过的最大路由器跳数，TTL 值越高，说明数据包在网络中 “存活” 的路径越短（或路由器转发规则更宽松）。

> 源主机发送数据包时，会设置一个初始 TTL 值，一般 Windows 系统默认为 128，Linux/Unix 默认为 64，网络设备通常为 255。

当数据包每经过一个路由器（一跳），TTL 值就减 1；当 TTL 减到 0 时，路由器会丢弃该数据包并返回“Time Exceeded”消息。

从示例中可以看出，GitHub 服务器很可能使用的是 **Windows系统或某些网络设备**（初始 TTL=128），**经过的路由器数量** = 128 - 100 = **28跳**。



