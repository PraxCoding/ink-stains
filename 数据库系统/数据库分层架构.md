## 数据库分层架构



<div align="center">
  <img src="assets/database architecture.jpeg" height="500">
</div>
此图描绘了一个典型数据库管理系统的分层架构：各类用户（如普通用户、应用程序员、分析师和管理员）通过应用程序接口、应用程序或查询工具与系统交互，其请求由查询处理器（包含 DDL 解释器、DML 编译器和查询评估引擎）进行解析、优化与执行；其下的存储管理器（由缓冲区管理器、文件管理器、事务管理器及授权与完整性管理器等组成）负责处理数据存取、事务、安全性与一致性；最后，所有数据、索引、数据字典和统计信息最终存储在物理磁盘上，共同构成一个从用户界面到物理存储的完整、多层次模块化系统。

## 顶层

不同类型的用户通过各自的专属入口与数据库系统进行交互。普通用户（如柜员、图形界面用户）通过应用接口来操作系统；应用程序员编写应用程序，并经编译器和链接器生成应用程序目标代码来与系统交互；数据分析师使用查询工具提交查询；数据库管理人员则通过专门的管理工具来管理数据库（如执行建表等 DDL 操作）。

## 数据库引擎

**查询处理器**主要处理数据操作语言 DML 和数据定义语言 DDL 。解释器解析语句，管理数据库结构；编译器和组织器（organizer）将查询语句转化为可执行的查询计划，查询评估引擎执行查询计划，调用管理器的底层功能。

**存储管理器**衔接查询处理器与磁盘缓存，负责数据存取、权限验证和事务保障等任务，其中，缓冲管理器负责协调磁盘与内存之间的数据交换，通过缓存提升访问效率；文件管理器管理磁盘上的数据文件，负责组织和空间分配；授权与完整性管理器会验证用户权限，确保数据的完整性（如字段唯一性、外键约束等）；事务管理器会保障事务的 ACID（原子性、一致性、隔离性和持久性）特性。

## 底层

磁盘存储数据库的核心数据与元数据，是数据持久化的载体，存储的内容包括业务数据（如用户表、实际订单）、索引（加速数据查询的结构，类似书籍“目录”）、数据字典（元数据，如表结构、字段类型及约束规则）和统计数据（记录数据分布，辅助查询优化）等内容。

不同用户通过专属入口发起请求，**查询处理器**将高层指令（如SQL）转化为底层可执行操作，**存储管理器**负责数据的安全存取与事务保障，最终与**磁盘存储**交互，完成“数据持久化”与“高效访问”的闭环。

## 参考文献

```tex
{
  author = "Abraham Silberschatz, Henry F. Korth, S. Sudarshan",
  type = "Book",
  booktitle = "Database System Concepts (Seventh Edition)",
  chapter = "1.7 Database and Application Architecture", 
  url = "https://www.db-book.com"
  publisher = "McGraw-Hill"
}
```
